<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd"
[
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "INCLUDE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<!-- influenced by http://ceph.com/docs/master/install/upgrading-ceph/ -->
<chapter id="cha.ceph.upgrade">
 <title>Upgrading from Previous Releases</title>
 <para>
  This chapter introduces steps to upgrade &storage; from the previous
  release to the current one.
 </para>
 <sect1 id="ceph.upgrade.extension">
  <title>&storage; Product Upgrade</title>

  <para>
   Before upgrading the &ceph; cluster itself, you need to add a new version
   of the &storage; product to the existing operating system, and update the
   software to the latest versions on each cluster node:
  </para>

  <procedure>
   <step>
    <para>
     Check that the latest patches are applied to the installed &sls;.
    </para>
<screen>sudo zypper ref &amp;&amp; sudo zypper patch</screen>
   </step>
   <step>
    <para>
     Install &storage; extension with
     <menuchoice><guimenu>&yast;</guimenu><guimenu>Software</guimenu><guimenu>Add-On
     Products</guimenu><guimenu>Add</guimenu></menuchoice>.
    </para>
   </step>
   <step>
    <para>
     After the new product is added, refresh the installed software
     repositories.
    </para>
<screen>sudo zypper ref</screen>
   </step>
   <step>
    <para>
     Upgrade the installed software to the new version.
    </para>
<screen>sudo zypper dup</screen>
   </step>
  </procedure>
 </sect1>
 <sect1 id="ceph.upgrade.general">
  <title>General Upgrade Procedure</title>

  <para>
   You can upgrade daemons in your &ceph; cluster while the cluster is
   online and in service. Certain types of daemons depend upon others. For
   example, &ceph; &rgw;s depend upon &ceph; Monitors and &ceph; OSD
   Daemons. We recommend upgrading in this order:
  </para>

  <orderedlist>
   <listitem>
    <para>
     The <command>ceph-deploy</command> utility.
    </para>
   </listitem>
   <listitem>
    <para>
     &ceph; monitors.
    </para>
   </listitem>
   <listitem>
    <para>
     &ceph; OSD daemons.
    </para>
   </listitem>
   <listitem>
    <para>
     &ceph; &rgw;s.
    </para>
   </listitem>
  </orderedlist>

  <tip>
   <para>
    As a general rule, we recommend upgrading all the daemons of a specific
    type (for example all <systemitem>ceph-mon</systemitem> daemons, all
    <systemitem>ceph-osd</systemitem> daemons, etc.) to ensure that they are
    all on the same release. We also recommend that you upgrade all the
    daemons in your cluster before you try to exercise new functionality in
    a release.
   </para>
  </tip>
 </sect1>
</chapter>
