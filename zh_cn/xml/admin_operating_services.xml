<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_operating_services.xml" version="5.0" xml:id="ceph.operating.services">
 <title>操作 Ceph 服务</title>
 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:translation>是</dm:translation>
        <dm:release>SES 5</dm:release>
      </dm:docmanager>
    </info>
    <para>
  使用 <command>systemctl</command> 命令可操作 Ceph 相关服务。操作在您当前登录的节点上进行。您需要具备 <systemitem class="username">root</systemitem> 特权才能操作 Ceph 服务。
 </para>
 <sect1 xml:id="ceph.operating.services.targets">
  <title>使用目标启动、停止和重启动服务</title>

  <para>
   为了简化启动、停止和重启动节点上特定类型的所有服务（例如所有 Ceph 服务、所有 MON 或所有 OSD）的操作，Ceph 提供了以下 <systemitem class="daemon">systemd</systemitem> 单元文件：
  </para>

<screen><prompt>root # </prompt> ls /usr/lib/systemd/system/ceph*.target
ceph.target
ceph-osd.target
ceph-mon.target
ceph-mgr.target
ceph-mds.target
ceph-radosgw.target
ceph-rbd-mirror.target</screen>

  <para>
   要启动/停止/重启动节点上的所有 Ceph 服务，请运行以下命令：
  </para>

<screen><prompt>root # </prompt>systemctl stop ceph.target
<prompt>root # </prompt>systemctl start ceph.target
<prompt>root # </prompt>systemctl restart ceph.target</screen>

  <para>
   要启动/停止/重启动节点上的所有 OSD，请运行以下命令：
  </para>

<screen><prompt>root # </prompt>systemctl stop ceph-osd.target
<prompt>root # </prompt>systemctl start ceph-osd.target
<prompt>root # </prompt>systemctl restart ceph-osd.target</screen>

  <para>
   用于其他目标的命令与此类似。
  </para>
 </sect1>
 <sect1 xml:id="ceph.operating.services.individual">
  <title>启动、停止和重启动个别服务</title>

  <para>
   可以使用以下参数化 <systemitem class="daemon">systemd</systemitem> 单元文件操作个别服务：
  </para>

<screen>ceph-osd@.service
ceph-mon@.service
ceph-mds@.service
ceph-radosgw@.service
ceph-rbd-mirror@.service</screen>

  <para>
   要使用这些命令，首先需要确定要操作的服务的名称。请参见<xref linkend="ceph.operating.services.finding_names"/>了解有关如何识别服务的更多信息。
  </para>

  <para>
   要启动/停止/重启动 <literal>osd.1</literal> 服务，请运行以下命令：
  </para>

<screen><prompt>root # </prompt>systemctl stop ceph-osd@1.service
<prompt>root # </prompt>systemctl start ceph-osd@1.service
<prompt>root # </prompt>systemctl restart ceph-osd@1.service</screen>

  <para>
   用于其他服务类型的命令与此类似。
  </para>
 </sect1>
 <sect1 xml:id="ceph.operating.services.finding_names">
  <title>识别个别服务</title>

  <para>
   通过运行 <command>systemctl</command> 并使用 <command>grep</command> 命令过滤结果，可以确定特定类型服务的名称/数目。例如：
  </para>

<screen><prompt>root # </prompt>systemctl | grep -i 'ceph-osd.*service'
<prompt>root # </prompt>systemctl | grep -i 'ceph-mon.*service'
[...]</screen>
 </sect1>
 <sect1 xml:id="ceph.operating.services.status">
  <title>服务状态</title>

  <para>
   可以查询 <systemitem class="daemon">systemd</systemitem> 来了解服务的状态。例如：
  </para>

<screen><prompt>root # </prompt>systemctl status ceph-osd@1.service
<prompt>root # </prompt>systemctl status ceph-mon@<replaceable>HOSTNAME</replaceable>.service</screen>

  <para>
   请将 <replaceable>HOSTNAME</replaceable> 替换为运行守护程序的主机名。
  </para>

  <para>
   如果您不知道服务的确切名称/数目，请参见<xref linkend="ceph.operating.services.finding_names"/>。
  </para>
 </sect1>
</chapter>
