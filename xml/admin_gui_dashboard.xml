<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id='ceph.oa'>
 <title>&dashboard;</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  The &dashboard; is a module that adds a built-in Web based monitoring and
  administration application to the &mgr; (refer to
  <xref linkend="storage.intro.core.nodes" /> for more details on &mgr;). You
  no longer need to know complex &ceph; related commands to manage and monitor
  your &ceph; cluster. You can either use the &dashboard;'s intuitive Web
  interface, or its built-in REST API.
 </para>
 <sect1 xml:id="dashboard.initial_configuration">
  <title>Initial Configuration</title>

  <para>
   This section introduces information that will help you do the initial setup
   so that you can enjoy the &dashboard;'s Web interface while managing your
   cluster.
  </para>

  <sect2 xml:id="dashboard.enable">
   <title>Enabling</title>
   <para>
    To enable the &dashboard; in a running &ceph; cluster, run:
   </para>
<screen>
&prompt.cephuser;ceph mgr module enable dashboard
</screen>
  </sect2>

  <sect2 xml:id="dashboard.ssl">
   <title>SSL/TLS Support</title>
   <para>
    All HTTP connections to the dashboard are secured with SSL/TLS by default.
    A secure connection requires an SSL certificate. You can either use a
    self-signed certificate, or generate a certificate and let a well known
    certificate authority (CA) sign it.
   </para>
   <tip>
    <title>Disabling SSL</title>
    <para>
     You may want to disable the SSL support for a specific reason. For example
     if the dashboard is running behind a proxy that does not support SSL.
    </para>
    <para>
     Use caution when disabling SSL as <emphasis role="bold">user names and
     passwords</emphasis> will be sent to the dashboard
     <emphasis role="bold">unencrypted</emphasis>.
    </para>
    <para>
     To disable SSL, run:
    </para>
<screen>
&prompt.cephuser;ceph config set mgr mgr/dashboard/ssl false
</screen>
   </tip>
   <tip>
    <title>Restart &mgr; Processes</title>
    <para>
     You need to restart the &mgr; processes manually after changing the SSL
     certificate and key. You can do so by either running
    </para>
<screen>
&prompt.cephuser;ceph mgr fail mgr
</screen>
    <para>
     or by disabling and re-enabling the dashboard module which also triggers
     the manager to respawn itself:
    </para>
<screen>
&prompt.cephuser;ceph mgr module disable dashboard
&prompt.cephuser;ceph mgr module enable dashboard
</screen>
   </tip>
   <sect3>
    <title>Self-signed Certificates</title>
    <para>
     To create a self-signed certificate for secure communication is simple.
     This way you can get the dashboard running quickly.
    </para>
    <note>
     <title>Web Browsers Complain</title>
     <para>
      Most Web browsers will complain about a self-signed certificate and
      require explicit confirmation before establishing a secure connection to
      the dashboard.
     </para>
    </note>
    <para>
     To generate and install a self-signed certificate, use the following
     built-in command:
    </para>
<screen>
&prompt.cephuser;ceph dashboard create-self-signed-cert
</screen>
   </sect3>
   <sect3>
    <title>Certificates Signed by CA</title>
    <para>
     To properly secure the connection to the dashboard and to remove the Web
     browser complaints about a self-signed certificate, we recommend using a
     certificate that is signed by a CA.
    </para>
    <para>
     You can generate a certificate key pair with a command similar to the
     following:
    </para>
<screen>
&prompt.root;openssl req -new -nodes -x509 \
  -subj "/O=IT/CN=ceph-mgr-dashboard" -days 3650 \
  -keyout dashboard.key -out dashboard.crt -extensions v3_ca
</screen>
    <para>
     The previous command outputs <filename>dashboard.key</filename> and
     <filename>dashboard.crt</filename> files. After you get the
     <filename>dashboard.crt</filename> file signed by a CA, enable it for all
     &mgr;s instances by running the following commands:
    </para>
<screen>
&prompt.cephuser;ceph config-key set mgr/dashboard/crt -i dashboard.crt
&prompt.cephuser;ceph config-key set mgr/dashboard/crt -i dashboard.key
</screen>
    <tip>
     <title>Different Certificate for each Manager Instance</title>
     <para>
      If you require different certificates for each &mgr; instance, modify the
      commands and include the name of the instance as follows. Replace
      <replaceable>NAME</replaceable> with the name of the &mgr; instance
      (usually the related host name):
     </para>
<screen>
&prompt.cephuser;ceph config-key set mgr/dashboard/<replaceable>NAME</replaceable>/crt -i dashboard.crt
&prompt.cephuser;ceph config-key set mgr/dashboard/<replaceable>NAME</replaceable>/crt -i dashboard.key
</screen>
    </tip>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard.hostname_port">
   <title>Host Name and Port Number</title>
   <para>
    The &dashboard; Web application binds to a specific TCP/IP address and TCP
    port. By default the currently active &mgr; that hosts the dashboard binds
    to TCP port 8443 (or 8080 when SSL is disabled).
   </para>
   <para>
    The dashboard Web application binds to "::" by default, which corresponds
    to all available IPv4 and IPv6 addresses. You can change the IP address and
    port number of the Web application so that they apply to all &mgr;
    instances by using the following commands:
   </para>
<screen>
&prompt.cephuser;ceph config set mgr mgr/dashboard/server_addr <replaceable>IP_ADDRESS</replaceable>
&prompt.cephuser;ceph config set mgr mgr/dashboard/server_port <replaceable>PORT_NUMBER</replaceable>
</screen>
   <tip>
    <title>Configure &mgr; Instances Separately</title>
    <para>
     Since each <systemitem class="daemon">ceph-mgr</systemitem> daemon hosts
     its own instance of the dashboard, you may need to configure them
     separately. Change the IP address and port number for a specific manager
     instance by using the following commands (replaace
     <replaceable>NAME</replaceable> with the ID of the
     <systemitem class="daemon">ceph-mgr</systemitem> instance):
    </para>
<screen>
&prompt.cephuser;ceph config set mgr mgr/dashboard/<replaceable>NAME</replaceable>/server_addr <replaceable>IP_ADDRESS</replaceable>
&prompt.cephuser;ceph config set mgr mgr/dashboard/<replaceable>NAME</replaceable>/server_port <replaceable>PORT_NUMBER</replaceable>
</screen>
   </tip>
   <tip>
    <title>List Configured Endpoints</title>
    <para>
     The <command>ceph mgr services</command> command displays all endpoints
     that are currently configured. Look for the 'dashboard' key to obtain the
     URL for accessing the dashboard.
    </para>
   </tip>
  </sect2>

  <sect2 xml:id="dashboard.username_password">
   <title>User Name and Password</title>
   <para>
    In order to log in to the dashboard Web application, you need to create a
    user account and associate it with at least one role. We provide a set of
    predefined system roles that you can use. For more details refer to
    <xref linkend="dashboard.user_roles" />.
   </para>
   <para>
    To create a user with the administrator, use the following command:
   </para>
<screen>
&prompt.cephuser;ceph dashboard ac-user-create <replaceable>USER_NAME</replaceable> <replaceable>PASSWORD</replaceable> administrator
</screen>
  </sect2>

  <sect2 xml:id="dashboard.ogw_enabling">
   <title>Enabling the &ogw; Management Frontend</title>
   <para>
    To use the &ogw; management functionality of the dashboard, you need to
    provide the login credentials of a user with the 'system' flag enabled:
   </para>
   <procedure>
    <step>
     <para>
      If you do not have a user with the 'system' flag, create them:
     </para>
<screen>
&prompt.cephuser;radosgw-admin user create --uid=<replaceable>USER_ID</replaceable> --display-name=<replaceable>DISPLAY_NAME</replaceable> --system
</screen>
     <para>
      Take note of the 'access_key' and 'secret_key' keys in the output of the
      command.
     </para>
    </step>
    <step>
     <para>
      You can also obtain the credentials of an existing user by using the
      <command>radosgw-admin</command> command:
     </para>
<screen>
&prompt.cephuser;radosgw-admin user info --uid=<replaceable>USER_ID</replaceable>
</screen>
    </step>
    <step>
     <para>
      Provide the received credentials to the dashboard:
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rgw-api-access-key <replaceable>ACCESS_KEY</replaceable>
&prompt.cephuser;ceph dashboard set-rgw-api-secret-key <replaceable>SECRET_KEY</replaceable>
</screen>
    </step>
   </procedure>
   <para>
    There are several points to consider:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      The host name and port number of the &ogw; are determined automatically.
     </para>
    </listitem>
    <listitem>
     <para>
      If multiple zones are used, it will automatically determine the host
      within the master zone group and master zone. This is sufficient for most
      setups, but in some circumstances you may want to set the host name and
      port manually:
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rgw-api-host <replaceable>HOST</replaceable>
&prompt.cephuser;ceph dashboard set-rgw-api-port <replaceable>PORT</replaceable>
</screen>
    </listitem>
    <listitem>
     <para>
      These are additional settings that you may need:
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rgw-api-scheme <replaceable>SCHEME</replaceable>  # http or https
&prompt.cephuser;ceph dashboard set-rgw-api-admin-resource <replaceable>ADMIN_RESOURCE</replaceable>
&prompt.cephuser;ceph dashboard set-rgw-api-user-id <replaceable>USER_ID</replaceable>
</screen>
    </listitem>
    <listitem>
     <para>
      If you are using a self-signed certificate
      (<xref linkend="dashboard.ssl" /> in your &ogw; setup, disable
      certificate verification in the dashboard to avoid refused connections
      caused by certificates signed by unknown CA or not matching the host
      name:
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rgw-api-ssl-verify False
</screen>
    </listitem>
    <listitem>
     <para>
      If the &ogw; takes too long to process requests and the dashboard runs
      into timeouts, then you can tune the timeout value (default is 45
      seconds):
     </para>
<screen>
&prompt.cephuser;ceph dashboard set-rest-requests-timeout <replaceable>SECONDS</replaceable>
</screen>
    </listitem>
   </itemizedlist>
  </sect2>

<!-- 2019-02-01 tbazant:
  the upstream version at http://docs.ceph.com/docs/master/mgr/dashboard/#enabling-the-embedding-of-grafana-dashboards
  is hard to understand, hopefully this will be deployed by DS soon

  <sect2 xml:id="dashboard.grafana">
   <title>Enabling Grafana Dashboards</title>
   <para>
    <emphasis>&prometheus;</emphasis> is a monitoring and alerting toolkit,
    while <emphasis>&grafana;</emphasis> is visualization and alerting
    software. They are both an essential part of &dashboard;.
   </para>
   <para>
    Following procedure describes manual steps to install and configure them
    manually:
   </para>
   <procedure>
    <step>
     <para>
      Enable the &ceph; Exporter which comes as &mgr; module:
     </para>
<screen>
&cephuser;ceph mgr module enable prometheus
</screen>
    </step>
    <step>
     <para>
      Add the corresponding scrape configuration to &prometheus;, probably
      similar to the following:
     </para>
<screen>
global:
  scrape_interval: 5s

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
  - job_name: 'ceph'
    static_configs:
      - targets: ['localhost:9283']
  - job_name: 'node-exporter'
    static_configs:
      - targets: ['localhost:9100']
</screen>
    </step>

   </procedure>
  </sect2>
-->

  <sect2 xml:id="dashboard.sso">
   <title>Enable &sso;</title>
   <para>
    <emphasis>&sso;</emphasis> (SSO) is an access control method that enables
    users to log in with a single ID and password to multiple applications
    simultaneously.
   </para>
   <para>
    The &dashboard; supports external authentication of users via the SAML 2.0
    protocol. Because <emphasis>authorization</emphasis> is still performed by
    the Dashboard, you first need to create user accounts and associate them
    with the desired roles. However, the <emphasis>authentication</emphasis>
    process can be performed by an existing <emphasis>Identity
    Provider</emphasis> (IdP).
   </para>
   <para>
    To configure &sso;, use the following command:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso setup saml2 <replaceable>CEPH_DASHBOARD_BASE_URL</replaceable> \
 <replaceable>IDP_METADATA</replaceable> <replaceable>IDP_USERNAME_ATTRIBUTE</replaceable> \
 <replaceable>IDP_ENTITY_ID</replaceable> <replaceable>SP_X_509_CERT</replaceable> \
 <replaceable>SP_PRIVATE_KEY</replaceable>
</screen>
   <para>
    Parameters:
   </para>
   <variablelist>
    <varlistentry>
     <term><replaceable>CEPH_DASHBOARD_BASE_URL</replaceable></term>
     <listitem>
      <para>
       Base URL where &dashboard; is accessible (for example
       'https://cephdashboard.local').
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_METADATA</replaceable></term>
     <listitem>
      <para>
       URL, file path, or content of the IdP metadata XML (for example
       'https://myidp/metadata').
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_USERNAME_ATTRIBUTE</replaceable></term>
     <listitem>
      <para>
       Optional. Attribute that will be used to get the user name from the
       authentication response. Defaults to 'uid'.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>IDP_ENTITY_ID</replaceable></term>
     <listitem>
      <para>
       Optional. Use when more than one entity ID exists on the IdP metadata.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>SP_X_509_CERT</replaceable> / <replaceable>SP_PRIVATE_KEY</replaceable></term>
     <listitem>
      <para>
       Optional. File path or content of the certificate that will be used by
       &dashboard; (Service Provider) for signing and encryption.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <note>
    <title>SAML Requests</title>
    <para>
     The issuer value of SAML requests will follow this pattern:
    </para>
<screen>
<replaceable>CEPH_DASHBOARD_BASE_URL</replaceable>/auth/saml2/metadata
</screen>
   </note>
   <para>
    To display the current SAML 2.0 configuration, run:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso show saml2
</screen>
   <para>
    To disable &sso;, run:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso disable
</screen>
   <para>
    To check if SSO is enabled, run:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso status
</screen>
   <para>
    To enable SSO, run:
   </para>
<screen>
&prompt.cephuser;ceph dashboard sso enable saml2
</screen>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard.user_roles">
  <title>User and Role Management</title>

  <para>
   This section describes how to manage user accounts used by the &dashboard;.
   It helps you create or modify user accounts, as well as set proper user
   roles and permissions.
  </para>

  <sect2 xml:id="dahsboard.user_accounts">
   <title>User Accounts</title>
   <para>
    &dashboard; supports managing multiple user accounts. Each user account
    consists of a username, a password (stored in encrypted form using
    <literal>bcrypt</literal>), an optional name, and an optional email
    address.
   </para>
   <para>
    User accounts are stored in &mon;’s configuration database and are
    globally shared across all &mgr; instances.
   </para>
   <para>
    Use the following commands to manage user accounts:
   </para>
   <variablelist>
    <varlistentry>
     <term>Show existing users:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-show [<replaceable>USERNAME</replaceable>]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Create a new user:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-create <replaceable>USERNAME</replaceable> [<replaceable>PASSWORD</replaceable>] [<replaceable>ROLENAME</replaceable>] [<replaceable>NAME</replaceable>] [<replaceable>EMAIL</replaceable>]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Delete a user:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-delete <replaceable>USERNAME</replaceable>
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Change password of a user:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-set-password <replaceable>USERNAME</replaceable> <replaceable>PASSWORD</replaceable>
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Modify user's name and email:</term>
     <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-set-info <replaceable>USERNAME</replaceable> <replaceable>NAME</replaceable> <replaceable>EMAIL</replaceable>
</screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard.permissions">
   <title>User Roles and Permissions</title>
   <para>
    This section describes what security scopes you can assign to a user role,
    how to manage user roles and assign them to user accounts.
   </para>
   <sect3>
    <title>Security Scopes</title>
    <para>
     User accounts are associated with a set of roles that define which
     dashboard topic the user can access. The dashboard topics are grouped
     within a <emphasis>security</emphasis> scope. Security scopes are
     predefined and static. The following security scopes are currently
     available:
    </para>
    <variablelist>
     <varlistentry>
      <term>hosts</term>
      <listitem>
       <para>
        Includes all features related to the <guimenu>Hosts</guimenu> menu
        entry.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>config-opt</term>
      <listitem>
       <para>
        Includes all features related to the management of &ceph; configuration
        options.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>pool</term>
      <listitem>
       <para>
        Includes all features related to pool management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>osd</term>
      <listitem>
       <para>
        Includes all features related to the &osd; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>monitor</term>
      <listitem>
       <para>
        Includes all features related to the &mon; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rbd-image</term>
      <listitem>
       <para>
        Includes all features related to the &rbd; image management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rbd-mirroring</term>
      <listitem>
       <para>
        Includes all features related to the &rbd; mirroring management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>iscsi</term>
      <listitem>
       <para>
        Includes all features related to &iscsi; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rgw</term>
      <listitem>
       <para>
        Includes all features related to the &ogw; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cephfs</term>
      <listitem>
       <para>
        Includes all features related to &cephfs; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>manager</term>
      <listitem>
       <para>
        Includes all features related to the &mgr; management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>log</term>
      <listitem>
       <para>
        Includes all features related to &ceph; logs management.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>grafana</term>
      <listitem>
       <para>
        Includes all features related to the &grafana; proxy.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>dashboard-settings</term>
      <listitem>
       <para>
        Allows changing dashboard settings.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
   <sect3>
    <title>User Roles</title>
    <para>
     A <emphasis>role</emphasis> specifies a set of mappings between a
     <emphasis>security scope</emphasis> and a set of
     <emphasis>permissions</emphasis>. There are four types of permissions:
     'read', 'create', 'update', and 'delete'.
    </para>
    <para>
     The following example specifies a role where a user has 'read' and
     'create' permissions for features related to pool management, and has full
     permissions for features related to RBD image management:
    </para>
<screen>
{
  'role': 'my_new_role',
  'description': 'My new role',
  'scopes_permissions': {
    'pool': ['read', 'create'],
    'rbd-image': ['read', 'create', 'update', 'delete']
  }
}
</screen>
    <para>
     The dashboard already provides a set of predefined roles that we call
     <emphasis>system roles</emphasis>. You can instantly use them after a
     fresh &dashboard; installation:
    </para>
    <variablelist>
     <varlistentry>
      <term>administrator</term>
      <listitem>
       <para>
        Provides full permissions for all security scopes.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>read-only</term>
      <listitem>
       <para>
        Provides read permission for all security scopes except the dashboard
        settings.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>block-manager</term>
      <listitem>
       <para>
        Provides full permissions for 'rbd-image', 'rbd-mirroring', and 'iscsi'
        scopes.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>rgw-manager</term>
      <listitem>
       <para>
        Provides full permissions for the 'rgw' scope
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cluster-manager</term>
      <listitem>
       <para>
        Provides full permissions for the 'hosts', 'osd', 'monitor', 'manager',
        and 'config-opt' scopes.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>pool-manager</term>
      <listitem>
       <para>
        Provides full permissions for the 'pool' scope.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>cephfs-manager</term>
      <listitem>
       <para>
        Provides full permissions for the 'cephfs' scope.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <sect4>
     <title>Managing Custom Roles</title>
     <para>
      You can create new user roles by using the following commands:
     </para>
     <variablelist>
      <varlistentry>
       <term>Create a new role:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-role-create <replaceable>ROLENAME</replaceable> [<replaceable>DESCRIPTION</replaceable>]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Delete a role:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-role-delete <replaceable>ROLENAME</replaceable>
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Add scope permissions to a role:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-role-add-scope-perms <replaceable>ROLENAME</replaceable> <replaceable>SCOPENAME</replaceable> <replaceable>PERMISSION</replaceable> [<replaceable>PERMISSION</replaceable>...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Delete scope permissions from a role:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-role-del-perms <replaceable>ROLENAME</replaceable> <replaceable>SCOPENAME</replaceable>
</screen>
       </listitem>
      </varlistentry>
     </variablelist>
    </sect4>
    <sect4>
     <title>Assigning Roles to User Accounts</title>
     <para>
      Use the following commands to assign roles to users:
     </para>
     <variablelist>
      <varlistentry>
       <term>Set user roles:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-set-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Add additional roles to a user:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-add-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Delete roles from a user:</term>
       <listitem>
<screen>
&prompt.cephuser;ceph dashboard ac-user-del-roles <replaceable>USERNAME</replaceable> <replaceable>ROLENAME</replaceable> [<replaceable>ROLENAME</replaceable> ...]
</screen>
       </listitem>
      </varlistentry>
     </variablelist>
    </sect4>
    <sect4>
     <title>Example: Creating a User and a Custom Role</title>
     <para>
      This section illustrates a procedure of creating a user account capable
      of managing RBD images, viewing and creating &ceph; pools, and having
      read-only access to any other scopes.
     </para>
     <procedure>
      <step>
       <para>
        Create a new user named 'tux':
       </para>
<screen>
 &prompt.cephuser;ceph dashboard ac-user-create tux <replaceable>PASSWORD</replaceable>
</screen>
      </step>
      <step>
       <para>
        Create a role and specify scope permissions:
       </para>
<screen>
&prompt.cephuser;ceph dashboard ac-role-create rbd/pool-manager
&prompt.cephuser;ceph dashboard ac-role-add-scope-perms rbd/pool-manager \
 rbd-image read create update delete
&prompt.cephuser;ceph dashboard ac-role-add-scope-perms rbd/pool-manager pool read create
</screen>
      </step>
      <step>
       <para>
        Associate the roles to the 'tux' user:
       </para>
<screen>
&prompt.cephuser;ceph dashboard ac-user-set-roles tux rbd/pool-manager read-only
</screen>
      </step>
     </procedure>
    </sect4>
   </sect3>
  </sect2>

  <sect2 xml:id="dashboard.proxy">
   <title>Reverse Proxies</title>
   <para>
    If you are accessing the dashboard via a reverse proxy configuration, you
    may need to service it under a URL prefix. To get the dashboard to use
    hyperlinks that include your prefix, you can set the
    <option>url_prefix</option> setting:
   </para>
<screen>
&prompt.cephuser;ceph config set mgr mgr/dashboard/url_prefix <replaceable>URL_PREFIX</replaceable>
</screen>
   <para>
    Then you can access the dashboard at
    <literal>http://<replaceable>HOST_NAME</replaceable>:<replaceable>PORT_NUMBER</replaceable>/<replaceable>URL_PREFIX</replaceable>/</literal>.
   </para>
  </sect2>

  <sect2 xml:id="dashboard.auditing">
   <title>Auditing</title>
   <para>
    The &dashboard;'s REST API can log PUT, POST and DELETE requests to the
    &ceph; audit log. Logging is disabled by default, but you can enable it
    with the following command:
   </para>
<screen>
&prompt.cephuser;ceph dashboard set-audit-api-enabled true
</screen>
   <para>
    If enabled, the following parameters are logged per each request:
   </para>
   <variablelist>
    <varlistentry>
     <term>from</term>
     <listitem>
      <para>
       The origin of the request, for example 'https://[::1]:44410'.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>path</term>
     <listitem>
      <para>
       The REST API path, for example '/api/auth'.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>method</term>
     <listitem>
      <para>
       'PUT', 'POST' or 'DELETE'.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>user</term>
     <listitem>
      <para>
       The name of the user (or ‘None’).
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    An example log entry looks like this:
   </para>
<screen>
2019-02-06 10:33:01.302514 mgr.x [INF] [DASHBOARD] \
 from='https://[::ffff:127.0.0.1]:37022' path='/api/rgw/user/exu' method='PUT' \
 user='admin' params='{"max_buckets": "1000", "display_name": "Example User", "uid": "exu", "suspended": "0", "email": "user@example.com"}'
</screen>
   <tip>
    <title>Disbale Logging of Request Payload</title>
    <para>
     The logging of the request payload (the list of arguments and their
     values) is enabled by default. You can disable it as follows:
    </para>
<screen>
&prompt.cephuser;ceph dashboard set-audit-api-log-payload false
</screen>
   </tip>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard.webui.general">
  <title>User Interface: General Description</title>

  <para>
   The &dashboard; user interface is graphically divided into several
   <emphasis>blocks</emphasis>: the <emphasis>utility menu</emphasis>, the
   <emphasis>main menu</emphasis>, and the main <emphasis>content
   pane</emphasis>.
  </para>

  <sect2 xml:id="dashboard.util_menu">
   <title>Utility Menu</title>
   <para>
    The top right part of the screen occupies a utility menu. It includes
    general tasks related more to the dashboard than to the &ceph; cluster. By
    clicking its items, you can access the following topics:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Change the language of the dashboard's user interface.
     </para>
    </listitem>
    <listitem>
     <para>
      Display a list of &ceph; related tasks that are running in the
      background.
     </para>
    </listitem>
    <listitem>
     <para>
      View and erase recent dashboard's notifications.
     </para>
    </listitem>
    <listitem>
     <para>
      Display a list of links that refer to the information about the
      dashboard, its complete documentation, and overview of its REST API.
     </para>
    </listitem>
    <listitem>
     <para>
      Manage dashboard's users and user roles. Refer to
      <xref linkend="dashboard.user_roles" /> for more detailed command line
      description.
     </para>
    </listitem>
    <listitem>
     <para>
      Sign you out of the dashboard.
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="dashboard.main_menu">
   <title>Main Menu</title>
   <para>
    The main dashboard's menu occupies the top left part of the screen. It
    covers the following topics:
   </para>
   <variablelist>
    <varlistentry>
     <term><guimenu>Dashboard</guimenu></term>
     <listitem>
      <para>
       Select the type of dashboard that you prefer.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Cluster</guimenu></term>
     <listitem>
      <para>
       View detailed information about overall cluster configuration and
       &crushmap;, its hosts, &osd;s, &mon;s, and the content of a log file.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Pools</guimenu></term>
     <listitem>
      <para>
       View and manage cluster pools.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Block</guimenu></term>
     <listitem>
      <para>
       Vie and manage block devices and their &iscsi; exports.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Filesystems</guimenu></term>
     <listitem>
      <para>
       View and manage &cephfs;s.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Object Gateway</guimenu></term>
     <listitem>
      <para>
       View and manage &ogw;'s daemons, users, and buckets.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard.cpane">
   <title>The Content Pane</title>
   <para>
    The content pane occupies the main part of the dashboard's screen. The
    dashboard home page shows plenty of helpful widgets to inform you briefly
    about the current status of the cluster, capacity, and performance
    information.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard.widgets">
  <title>Dashboard Widgets</title>

  <para>
   Each dashboard widget shows specific status information related to a
   specific aspect of a running &ceph; cluster. Some widgets are active links
   and after clicking them, they will redirect you to a related detailed page
   of the topic they represent.
  </para>

  <tip>
   <title>More Details on Mouse Over</title>
   <para>
    Some graphical widgets show you more detail when you move the mouse over
    them.
   </para>
  </tip>

  <sect2 xml:id="dashboard.widgets.status">
   <title>Status Widgets</title>
   <para>
    <guimenu>Status</guimenu> widgets give you a brief overview about the
    cluster current status.
   </para>
   <variablelist>
    <varlistentry>
     <term><guimenu>Cluster Status</guimenu></term>
     <listitem>
      <para>
       Presents basic information about the cluster's health.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Monitors</guimenu></term>
     <listitem>
      <para>
       Shows the number of running monitors and their quorum.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>OSDs</guimenu></term>
     <listitem>
      <para>
       Shows the total number of OSDs, as well as the number of 'up' and 'in'
       OSDs.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Manager Daemons</guimenu></term>
     <listitem>
      <para>
       Shows the number of active and standby &mgr; daemons.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Hosts</guimenu></term>
     <listitem>
      <para>
       Shows the total number of cluster nodes.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Object Gateways</guimenu></term>
     <listitem>
      <para>
       Shows the number of running &ogw;s.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Metadata Servers</guimenu></term>
     <listitem>
      <para>
       Shows the number of &mds;.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>iSCSI Gateway</guimenu></term>
     <listitem>
      <para>
       Shows the number configured of &iscsi; gateways.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard.widgets.performance">
   <title>Performance Widgets</title>
   <para>
    <guimenu>Performance</guimenu> widgets refer to basic performance data of
    &ceph; clients.
   </para>
   <variablelist>
    <varlistentry>
     <term><guimenu>Client IOPS</guimenu></term>
     <listitem>
      <para></para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Client Throughput</guimenu></term>
     <listitem>
      <para></para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Client Read/Write</guimenu></term>
     <listitem>
      <para></para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Client Recovery</guimenu></term>
     <listitem>
      <para></para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Scrub</guimenu></term>
     <listitem>
      <para></para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="dashboard.widgets.capacity">
   <title>Capacity Widgets</title>
   <para>
    <guimenu>Capacity</guimenu> widgets show brief information about the
    storage capacity.
   </para>
   <variablelist>
    <varlistentry>
     <term><guimenu>Pools</guimenu></term>
     <listitem>
      <para>
       Shows the number of pools in the cluster.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Raw Capacity</guimenu></term>
     <listitem>
      <para>
       Shows the ratio of used and available raw storage capacity.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Objects</guimenu></term>
     <listitem>
      <para>
       Shows the number of data objects stored in the cluster.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>PGs per OSD</guimenu></term>
     <listitem>
      <para>
       Shows the number of placement groups per OSD.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>PG Status</guimenu></term>
     <listitem>
      <para>
       Displays the chart of placement groups according to their status.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboard.ui.common">
  <title>Common Web UI Features</title>

  <para>
   In &dashboard;, you often work with <emphasis>lists</emphasis>&mdash;for
   example, lists of pools, OSD nodes, or RBD devices. The following common
   widgets help you manage or adjust these list:
  </para>

  <para>
   Click <inlinemediaobject>
   <imageobject role="fo">
    <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="oa_widget_reload.png" width="1.2em" format="PNG"/>
   </imageobject>
   </inlinemediaobject> to refresh the list of items.
  </para>

  <para>
   Click <inlinemediaobject>
   <imageobject role="fo">
    <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="oa_widget_columns.png" width="1.3em" format="PNG"/>
   </imageobject>
   </inlinemediaobject> to display or hide individual table columns.
  </para>

  <para>
   Click <inlinemediaobject>
   <imageobject role="fo">
    <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="oa_widget_rows.png" width="1.8em" format="PNG"/>
   </imageobject>
   </inlinemediaobject> and select how many rows to display on a single page.
  </para>

  <para>
   Click inside <inlinemediaobject>
   <imageobject role="fo">
    <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="oa_widget_search.png" width="5em" format="PNG"/>
   </imageobject>
   </inlinemediaobject> and filter the rows by typing the string to search for.
  </para>

  <para>
   Use <inlinemediaobject>
   <imageobject role="fo">
    <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="oa_widget_pager.png" width="6em" format="PNG"/>
   </imageobject>
   </inlinemediaobject> to change the currently displayed page if the list
   spans across multiple pages.
  </para>
 </sect1>
 <sect1 xml:id="dashboard.cluster">
  <title>Viewing Cluster Internals</title>

  <para>
   The <guimenu>Cluster</guimenu> menu item lets you view detailed information
   about &ceph; cluster hosts, OSDs, MONs, &crushmap;, and the content of log
   files.
  </para>

  <sect2 xml:id="dashboard.cluster.hosts">
   <title>Cluster Nodes</title>
   <para>
    Click
    <menuchoice><guimenu>Cluster</guimenu><guimenu>Hosts</guimenu></menuchoice>
    to view a list of cluster nodes.
   </para>
   <para>
    Click a node name in the <guimenu>Hostname</guimenu> column to view
    performance details of the node.
   </para>
   <para>
    The <guimenu>Services</guimenu> column lists all daemons that are running
    on each related node. Click a daemon name to view its detailed
    configuration.
   </para>
  </sect2>

  <sect2 xml:id="dashboard.cluster.monitors">
   <title>&mon;s</title>
   <para>
    Click
    <menuchoice><guimenu>Cluster</guimenu><guimenu>Monitors</guimenu></menuchoice>
    to view a list of cluster nodes with running &ceph; monitors. The list
    includes each monitor's rank number, public IP address, and number of open
    sessions.
   </para>
   <para>
    The list is divided into two tables: one for &mon;s that
    <emphasis>are</emphasis> in quorum, and the second one for &mon;s that
    <emphasis>are not</emphasis> in quorum.
   </para>
   <para>
    Click a node name in the <guimenu>Name</guimenu> column to view the related
    &mon; configuration.
   </para>
   <para>
    The <guimenu>Status</guimenu> table shows general statistics about the
    running &mon;s.
   </para>
  </sect2>

  <sect2 xml:id="dashboard.cluster.osds">
   <title>&osd;s</title>
   <para>
    Click
    <menuchoice><guimenu>Cluster</guimenu><guimenu>OSDs</guimenu></menuchoice>
    to view a list of nodes with running OSD daemons/disks. The list includes
    each node's name, status, number of placement groups, size, usage,
    reads/writes chart in time, and the rate of read/write operations per
    second.
   </para>
   <para>
    Click <guimenu>Set Cluster-wide Flags</guimenu> in the table heading to pop
    up a window with a list of flags that apply to the whole cluster. You can
    activate or deactivate individual flags, and confirm with
    <guimenu>Submit</guimenu>.
   </para>
   <para>
    Click <guimenu>Set Cluster-wide Recovery Priority</guimenu> to in the table
    heading to pop up a window with a list of OSD recovery priorities that
    apply to the whole cluster. You can activate the preferred priority
    profile, and fine tune the individual values below. Confirm with
    <guimenu>Submit</guimenu>.
   </para>
   <para>
    Click a node name in the <guimenu>Host</guimenu> column to view an extended
    table with details about the OSD setting and performance. Browsing through
    several tabs, you can see lists of <guimenu>Attributes</guimenu>,
    <guimenu>Metadata</guimenu>, <guimenu>Performance counter</guimenu>, and a
    graphical <guimenu>Histogram</guimenu> of reads and writes.
   </para>
   <tip>
    <title>Perform Specific Tasks on OSDs</title>
    <para>
     After you click an OSD node name, its table row changes color slightly
     meaning that you can now perform a task on the node. Click the down arrow
     in the top left of the table heading and select a task to perform, such as
     <guimenu>Deep Scrub</guimenu>. Optionally enter a required value for the
     task, and confirm to run it on the node.
    </para>
   </tip>
  </sect2>
 </sect1>
 <sect1 xml:id="oa.rbds">
  <title>Managing RADOS Block Devices (RBDs)</title>

  <para>
   To list all available &rbd;s, click <guimenu>RBDs</guimenu> from the main
   menu.
  </para>

  <para>
   The list shows each device's name, the related pool name, size of the
   device, and, if 'fast-diff' was enabled during the &rbd; creation, the
   percentage that is already occupied.
  </para>

  <figure>
   <title>List of RBDs</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_rbds.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_rbds.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2>
   <title>Status Information</title>
   <para>
    To view more detailed information about a device, activate its check box in
    the very left column:
   </para>
   <figure>
    <title>RBD Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rbd_status.png" width="40%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rbd_status.png" width="40%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2>
   <title>Statistics</title>
   <para>
    Click the <guimenu>Statistics</guimenu> tab of an &rbd; to view the
    statistics of transferred data. You can zoom in and out the time range
    either by highlighting the time range with a mouse, or by selecting it
    after clicking the date in the top left corner of the tab.
   </para>
  </sect2>

  <sect2>
   <title>&rbd; Snapshots</title>
   <para>
    To create an &rbd; snapshot, click its <guimenu>Snapshots</guimenu> tab and
    select <guimenu>Create</guimenu> from the left top drop-down box.
   </para>
   <para>
    After selecting a snapshot, you can rename, protect, clone, or delete it.
    Deletion also works if you select multiple snapshots.
    <guimenu>Rollback</guimenu> restores the device's state from the current
    snapshot.
   </para>
   <figure>
    <title>RBD Snapshots</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rbd_snapshots.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rbd_snapshots.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2>
   <title>Deleting RBDs</title>
   <para>
    To delete a device or a group of devices, activate their check boxes in the
    very left column and click <guimenu>Delete</guimenu> in the top-left of the
    RBDs table:
   </para>
   <figure>
    <title>Deleting RBD</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rbd_delete.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rbd_delete.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2>
   <title>Adding RBDs</title>
   <para>
    To add a new device, click <guimenu>Add</guimenu> in the top left of the
    RBDs table and do the following on the <guimenu>Create RBD</guimenu>
    screen:
   </para>
   <figure>
    <title>Adding a New RBD</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rbd_add.png" width="90%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rbd_add.png" width="90%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      Enter the name of the new device. Refer to
      <xref linkend="sysreq.naming"/> for naming limitations.
     </para>
    </step>
    <step>
     <para>
      Select the cluster that will store the new pool.
     </para>
    </step>
    <step>
     <para>
      Select the pool from which the new RBD device will be created.
     </para>
    </step>
    <step>
     <para>
      Specify the size of the new device. If you click the <guimenu>use
      max</guimenu> link above, the maximum pool size is populated.
     </para>
    </step>
    <step>
     <para>
      To fine-tune the device parameters, click <guimenu>Expert
      settings</guimenu> and activate or deactivate the displayed options.
     </para>
    </step>
    <step>
     <para>
      Confirm with <guimenu>Create</guimenu>.
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="dashboar.ui.pools">
  <title>Managing Pools</title>

  <tip>
   <title>More Information on Pools</title>
   <para>
    For more general information about &ceph; pools, refer to
    <xref linkend="ceph.pools"/>. For information specific to erasure coded
    pools, refer to <xref linkend="cha.ceph.erasure"/>.
   </para>
  </tip>

  <para>
   To list all available pools, click <guimenu>Pools</guimenu> from the main
   menu.
  </para>

  <para>
   The list shows each pool's name, ID, the percentage of used space, the
   number of placement groups, replica size, type ('replicated' or 'erasure'),
   erasure code profile, and the CRUSH ruleset.
  </para>

  <figure>
   <title>List of Pools</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_pools.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   To view more detailed information about a pool, activate its check box in
   the very left column:
  </para>

  <figure>
   <title>Pool Details</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_pools_status.png" width="40%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_pools_status.png" width="40%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2>
   <title>Deleting Pools</title>
   <para>
    To delete a pool or a group of pools, activate their check boxes in the
    very left column and click <guimenu>Delete</guimenu> in the top left of the
    pools table:
   </para>
   <figure>
    <title>Deleting Pools</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_pools_delete.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_pools_delete.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2>
   <title>Adding Pools</title>
   <para>
    To add a new pool, click <guimenu>Add</guimenu> in the top left of the
    pools table and do the following on the <guimenu>Create Ceph pool</guimenu>
    screen:
   </para>
   <figure>
    <title>Adding a New Pool</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_pools_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      Enter the name of the new pool. Refer to <xref linkend="sysreq.naming"/>
      for naming limitations.
     </para>
    </step>
    <step>
     <para>
      Select the cluster that will store the new pool.
     </para>
    </step>
    <step>
     <para>
      Select the pool type. Pools can be either replicated or erasure coded.
     </para>
    </step>
    <step>
     <substeps>
      <step>
       <para>
        For a replicated pool, specify the replica size and the number of
        placement groups.
       </para>
      </step>
      <step>
       <para>
        For an erasure coded pool, specify the number of placement groups and
        erasure code profile. You can add your custom profile by clicking the
        plus '+' sign and specifying the profile name, data and coding chunks,
        and a ruleset failure domain.
       </para>
      </step>
     </substeps>
    </step>
    <step>
     <para>
      Confirm with <guimenu>Create</guimenu>.
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="ceph.oa.minions">
  <title>Listing Nodes</title>

  <para>
   Click <guimenu>Nodes</guimenu> from the main menu to view the list of nodes
   available on the cluster.
  </para>

  <figure>
   <title>List of Nodes</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_minion.png" width="70%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_minion.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   Each node is represented by its host name, public IP address, cluster ID it
   belongs to, node role (for example, 'admin', 'storage', or 'master'), and
   key acceptance status.
  </para>
 </sect1>
 <sect1 xml:id="oa.webui.nfs">
  <title>Managing &ganesha;</title>

  <tip>
   <title>More Information on &ganesha;</title>
   <para>
    For more general information about &ganesha;, refer to
    <xref linkend="cha.ceph.nfsganesha"/>.
   </para>
  </tip>

  <para>
   To list all available NFS exports, click <guimenu>NFS</guimenu> from the
   main menu.
  </para>

  <para>
   The list shows each export's directory, host name, status, type of storage
   back-end, and access type.
  </para>

  <figure>
   <title>List of NFS Exports</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_nfs.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   To view more detailed information about an NFS export, activate its check
   box in the very left column:
  </para>

  <figure>
   <title>NFS Export Details</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_nfs_status.png" width="40%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <tip>
   <title>NFS Mount Command</title>
   <para>
    At the bottom of the export detailed view, there is a mount command for you
    to be able to easily mount the related NFS export from a client machine.
   </para>
  </tip>

  <sect2>
   <title>Adding NFS Exports</title>
   <para>
    To add a new NFS export, click <guimenu>Add</guimenu> in the top left of
    the exports table and enter the required information.
   </para>
   <figure>
    <title>Adding a New NFS Export</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      Select a server host for the NFS export.
     </para>
    </step>
    <step>
     <para>
      Select a storage back-end&mdash;either <guimenu>CephFS</guimenu> or
      <guimenu>Object Gateway</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Enter the directory path for the NFS export. If the directory does not
      exist on the server, it will be created.
     </para>
    </step>
    <step>
     <para>
      Specify other NFS related options, such as supported NFS protocol
      version, access type, squashing, or transport protocol.
     </para>
    </step>
    <step>
     <para>
      If you need to limit access to specific clients only, click <guimenu>Add
      clients</guimenu> and add their IP addresses together with access type
      and squashing options.
     </para>
    </step>
    <step>
     <para>
      Confirm with <guimenu>Submit</guimenu>.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2>
   <title>Cloning and Deleting NFS Exports</title>
   <para>
    To delete an export or a group of exports, activate their check boxes in
    the very left column and select <guimenu>Delete</guimenu> in the top left
    of the exports table.
   </para>
   <para>
    Similarly, you can select <guimenu>Clone</guimenu> to clone the activated
    gateway.
   </para>
  </sect2>

  <sect2>
   <title>Editing NFS Exports</title>
   <para>
    To edit an existing export, either click its name in the exports table, or
    activate its check box and click <guimenu>Edit</guimenu> in the top left of
    the exports table.
   </para>
   <para>
    You can then adjust all the details of the NFS export.
   </para>
   <figure>
    <title>Editing an NFS Export</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_nfs_edit.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>
 </sect1>
 <sect1 xml:id="oa.webui.iscsi">
  <title>Managing &igw;s</title>

  <tip>
   <title>More Information on &igw;s</title>
   <para>
    For more general information about &igw;s, refer to
    <xref linkend="cha.ceph.as.iscsi"/> and <xref linkend="cha.ceph.iscsi"/>.
   </para>
  </tip>

  <para>
   To list all available gateways, click <guimenu>iSCSI</guimenu> from the main
   menu.
  </para>

  <para>
   The list shows each gateway's target, state, and related portals and RBD
   images.
  </para>

  <figure>
   <title>List of &igw;s</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_igws.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_igws.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   To view more detailed information about a gateway, activate its check box in
   the very left column:
  </para>

  <figure>
   <title>Gateway Details</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_igws_status.png" width="40%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_igws_status.png" width="40%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2>
   <title>Adding &igw;s</title>
   <para>
    To add a new &igw;, click <guimenu>Add</guimenu> in the top left of the
    gateways table and enter the required information.
   </para>
   <figure>
    <title>Adding a New &igw;</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_igws_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_igws_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      Enter the target address of the new gateway.
     </para>
    </step>
    <step>
     <para>
      Click <guimenu>Add portal</guimenu> and select one or multiple iSCSI
      portals from the list.
     </para>
    </step>
    <step>
     <para>
      Click <guimenu>Add image</guimenu> and select one or multiple RBD images
      for the gateway.
     </para>
    </step>
    <step>
     <para>
      If you need to use authentication to access the gateway, activate the
      <guimenu>Authentication</guimenu> check box and enter the credentials.
      You can find more advanced authentication options after activating
      <guimenu>Mutual authentication</guimenu> and <guimenu>Discovery
      authentication</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Confirm with <guimenu>Submit</guimenu>.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2>
   <title>Editing &igw;s</title>
   <para>
    To edit an existing &igw;, either click its name in the gateways table, or
    activate its check box and click <guimenu>Edit</guimenu> in the top left of
    the gateways table.
   </para>
   <para>
    You can then modify the &iscsi; target, add or delete portals, and add or
    delete related RBD images. You can also adjust authentication information
    for the gateway.
   </para>
  </sect2>

  <sect2>
   <title>Cloning and Deleting &igw;s</title>
   <para>
    To delete a gateway or a group of gateways, activate their check boxes in
    the very left column and select <guimenu>Delete</guimenu> in the top left
    of the gateways table.
   </para>
   <para>
    Similarly, you can select <guimenu>Clone</guimenu> to clone the activated
    gateway.
   </para>
  </sect2>

  <sect2>
   <title>Starting and Stopping &igw;s</title>
   <para>
    To start all gateways, select <guimenu>Start all</guimenu> in the top left
    of the gateways table. To stop all gateways, select <guimenu>Stop
    all</guimenu>.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="ceph.oa.crushmap">
  <title>Viewing the Cluster &crushmap;</title>

  <para>
   Click <guimenu>CRUSH Map</guimenu> from the main menu to view cluster
   &crushmap;.
  </para>

  <figure>
   <title>CRUSH Map</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_crush.png" width="60%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_crush.png" width="60%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   In the <guimenu>Physical setup</guimenu> pane, you can see the structure of
   the cluster as described by the &crushmap;.
  </para>

  <para>
   In the <guimenu>Replication rules</guimenu> pane, you can view individual
   rulesets after selecting one of them from the <guimenu>Content</guimenu>
   drop-down box.
  </para>

  <figure>
   <title>Replication rules</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_crush_rulesets.png" width="60%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_crush_rulesets.png" width="60%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 xml:id="oa.webui.rgw_users">
  <title>Managing &ogw; Users and Buckets</title>

  <tip>
   <title>More Information on &ogw;s</title>
   <para>
    For more general information about &ogw;s, refer to
    <xref linkend="cha.ceph.gw"/>.
   </para>
  </tip>

  <para>
   To list &ogw; users, select <menuchoice><guimenu>Object
   Gateway</guimenu><guimenu>Users</guimenu></menuchoice> from the main menu.
  </para>

  <para>
   The list shows each user's ID, display name, e-mail address, if the user is
   suspended, and the maximum number of buckets for the user.
  </para>

  <figure>
   <title>List of &ogw; Users</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="oa_rgw_users_list.png" width="90%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="oa_rgw_users_list.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <sect2 xml:id="oa.rgw_user.add">
   <title>Adding a New &ogw; User</title>
   <para>
    To add a new &ogw; user, click <guimenu>Add</guimenu> in the top left of
    the users' table and enter the relevant information.
   </para>
   <tip>
    <title>More Information</title>
    <para>
     Find more information about &ogw; user accounts in
     <xref linkend="s3.swift.accounts.managment"/>.
    </para>
   </tip>
   <figure>
    <title>Adding a New &ogw; User</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_rgw_users_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_rgw_users_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <procedure>
    <step>
     <para>
      Enter the user name, full name, and optionally an e-mail address and the
      maximum number of buckets for the user.
     </para>
    </step>
    <step>
     <para>
      If the user should be initially suspended, activate the
      <guimenu>Suspended</guimenu> check box.
     </para>
    </step>
    <step>
     <para>
      Specify the access and secret keys for the S3 authentication. If you want
      &dashboard; to generate the keys for you, activate <guimenu>Generate
      key</guimenu>.
     </para>
    </step>
    <step>
     <para>
      In the <guimenu>User quota</guimenu> section, set quota limits for the
      current user.
     </para>
     <para>
      Check <guimenu>Enabled</guimenu> to activate the user quota limits. You
      can either specify the <guimenu>Maximum size</guimenu> of the disk space
      the user can use within the cluster, or check <guimenu>Unlimited
      size</guimenu> for no size limit.
     </para>
     <para>
      Similarly, specify <guimenu>Maximum objects</guimenu> that the user can
      store on the cluster storage, or <guimenu>Unlimited objects</guimenu> if
      the user may store any number of objects.
     </para>
     <figure>
      <title>User quota</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="oa_rgw_userquota.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="oa_rgw_userquota.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      In the <guimenu>Bucket Quota</guimenu> section, set the bucket quota
      limits for the current user.
     </para>
     <figure>
      <title>Bucket Quota</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="oa_rgw_bucketquota.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="oa_rgw_bucketquota.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </step>
    <step>
     <para>
      Confirm with <guimenu>Submit</guimenu>.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2>
   <title>Deleting &ogw; Users</title>
   <para>
    To delete one or more &ogw; users, activate their check boxes in the very
    left column and select <guimenu>Delete</guimenu> in the top left of the
    users table.
   </para>
  </sect2>

  <sect2 xml:id="oa.user.edit">
   <title>Editing &ogw; Users</title>
   <para>
    To edit the user information of an &ogw; user, either activate their check
    box in the very left column and select <guimenu>Edit</guimenu> in the top
    left of the users table, or click their ID. You can change the information
    you entered when adding the user in <xref linkend="oa.rgw_user.add"/>, plus
    the following additional information:
   </para>
   <variablelist>
    <varlistentry>
     <term>Subusers</term>
     <listitem>
      <para>
       Add, remove, or edit subusers of the currently edited user.
      </para>
      <figure>
       <title>Adding a Subuser</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="oa_rgw_subuser_add.png" width="70%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="oa_rgw_subuser_add.png" width="70%" format="PNG"/>
        </imageobject>
       </mediaobject>
      </figure>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Keys</term>
     <listitem>
      <para>
       Add, remove, or view access and secret keys of the currently edited
       user.
      </para>
      <para>
       You can add S3 keys for the currently edited user, or view Swift keys
       for their subusers.
      </para>
      <figure>
       <title>View S3 keys</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="oa_rgw_user_s3key_edit.png" width="70%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="oa_rgw_user_s3key_edit.png" width="70%" format="PNG"/>
        </imageobject>
       </mediaobject>
      </figure>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Capabilities</term>
     <listitem>
      <para>
       Add or remove user's capabilities. The capabilities apply to
       <guimenu>buckets</guimenu>, <guimenu>zone</guimenu>,
       <guimenu>users</guimenu>, <guimenu>metadata</guimenu>, and
       <guimenu>usage</guimenu>. Each capability value can be one of 'read',
       'write', or '*' for read and write privilege.
      </para>
      <figure>
       <title>Capabilities</title>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="oa_rgw_user_capabs.png" width="70%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="oa_rgw_user_capabs.png" width="70%" format="PNG"/>
        </imageobject>
       </mediaobject>
      </figure>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="oa.ogw_bucket.list">
   <title>Listing Buckets for &ogw; Users</title>
   <tip>
    <para>
     A bucket is a mechanism for storing data objects. A user account may have
     many buckets, but bucket names must be unique. Although the term 'bucket'
     is normally used within the Amazon S3 API, the term 'container' is used in
     the &ostack; Swift API context.
    </para>
   </tip>
   <para>
    Click <menuchoice><guimenu>Object
    Gateway</guimenu><guimenu>Buckets</guimenu></menuchoice> to list all
    available &ogw; buckets.
   </para>
   <figure>
    <title>&ogw; Buckets</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="os_ogw_bucket_list.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="os_ogw_bucket_list.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="oa.ogw_bucket.add">
   <title>Adding Buckets for &ogw; Users</title>
   <para>
    To add a new bucket, click <guimenu>Add</guimenu> in the top left of the
    buckets table and enter the new bucket name and the related &ogw; user.
    Confirm with <guimenu>Submit</guimenu>.
   </para>
   <figure>
    <title>Adding a New Bucket</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_ogw_bucket_add.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_ogw_bucket_add.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="oa.ogw_bucket.view">
   <title>Viewing Bucket Details</title>
   <para>
    To view detailed information about an &ogw; bucket, activate its check box
    in the very left column of the buckets table.
   </para>
   <figure>
    <title>Bucket Details</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_ogw_bucket_view.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_ogw_bucket_view.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 xml:id="oa.ogw_bucket.edit">
   <title>Editing Buckets</title>
   <para>
    To edit a bucket, either activate its check box in the very left column and
    select <guimenu>Edit</guimenu> in the top left of the buckets table, or
    click its name.
   </para>
   <figure>
    <title>Editing an &ogw; Bucket</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_ogw_bucket_edit.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_ogw_bucket_edit.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    On the edit screen, you can change the user to which the bucket belongs.
   </para>
  </sect2>

  <sect2 xml:id="oa.ogw_bucket.delete">
   <title>Deleting Buckets</title>
   <para>
    To delete one or more &ogw; buckets, activate their check boxes in the very
    left column of the buckets table, and select <guimenu>Delete</guimenu> in
    the top left of the table.
   </para>
   <figure>
    <title>Deleting Buckets</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="oa_ogw_buckets_delete.png" width="70%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="oa_ogw_buckets_delete.png" width="70%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    To confirm the deletion, type 'yes' in the <guimenu>Delete
    buckets</guimenu> pop-up window, and click <guimenu>Delete</guimenu>.
   </para>
   <warning>
    <title>Careful Deletion</title>
    <para>
     When deleting an &ogw; bucket, it is currently not verified if the bucket
     is actually in use, for example by &ganesha; via the S3 storage back-end.
    </para>
   </warning>
  </sect2>
 </sect1>
</chapter>
